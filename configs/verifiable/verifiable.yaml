# Verifiable WMTP (Stage 2)
# WMTP with TD error-based token weighting

experiment:
  name: verifiable-wmtp
  description: "WMTP with TD error-based token weighting"
  stage: verifiable
  tags:
    - verifiable
    - wmtp
    - stage2
  critic_checkpoint: storage/checkpoints/critic/critic-pretrain/checkpoint_best.pt

# models 섹션은 defaults.yaml 사용 (meta-llama-mtp + tokenizer)

dataset:
  name: codecontests
  train: storage/datasets_v2/codecontests/processed/train.jsonl
  validation: storage/datasets_v2/codecontests/processed/valid.jsonl
  max_length: 2048

data_sampling:
  n_samples: 100000
  balance_correct: true
  correct_ratio: 0.5
  curriculum_learning: true
  difficulty_bins:
    low: [1, 3]
    medium: [4, 7]
    high: [8, 11]
  curriculum_schedule:
    - epoch_range: [0.0, 0.3]
      difficulty_weights:
        low: 0.7
        medium: 0.3
        high: 0.0
    - epoch_range: [0.3, 0.7]
      difficulty_weights:
        low: 0.3
        medium: 0.6
        high: 0.1
    - epoch_range: [0.7, 1.0]
      difficulty_weights:
        low: 0.1
        medium: 0.5
        high: 0.4
  seed: 42

training:
  n_epochs: 2.5
  batch_size: 4
  gradient_accumulation_steps: 4
  learning_rate: 1.0e-5
  beta: 0.9
  value_coef: 0.5
  max_grad_norm: 0.5
  loss_type: mse
  weight_clip_min: 0.1
  weight_clip_max: 5.0
  log_interval: 10

checkpoint:
  save_dir: storage/checkpoints/verifiable/${experiment.name}
  save_checkpoint_every: 1.0
  save_best: true
  save_final: true
  save_total_limit: 3
